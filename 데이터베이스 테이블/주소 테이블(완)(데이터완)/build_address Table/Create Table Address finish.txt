# Address 테이블 생성
create table address(
address_id number(7,0) primary key,
province varchar2(80) not null,
district varchar2(80) null,
road_name varchar2(80) not null,
building varchar2(80) null,
search varchar2(300) not null);

# 기존 데이터 Address 테이블로 합치기
INSERT INTO address (address_id, province, district, road_name, building, search)
SELECT
   address_id.NEXTVAL AS address_id,
   C.province AS province,
   C.district AS district,
   C.road_name AS road_name,
   S.official_building_name AS building,
   TRIM(NVL(C.district, NULL) || ' ' || C.road_name || ' ' || DECODE(A.building_num_sub, 0, TO_CHAR(A.building_num_main), TO_CHAR(A.building_num_main || '-' || A.building_num_sub)) || ' ' || DECODE(S.official_building_name, null, null,S.official_building_name)) AS search
FROM
   road_address A, road_code C, road_subdata S
WHERE
   A.address_code = S.address_code AND
   A.road_code = C.road_code AND
   A.town_code = C.town_code;

# Address 테이블 인덱스 생성 (CONTEXT)
CREATE INDEX address_search
ON address(search)
INDEXTYPE IS CTXSYS.CONTEXT;