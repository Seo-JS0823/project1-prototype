# Address 테이블 생성
create table address(
address_id number(9,0) primary key,
province varchar2(80) not null,
district varchar2(80) null,
road_name varchar2(80) not null,
building varchar2(80) null);

# ADDRESS_ID 시퀀스 생성
create sequence address_id
start with 1
increment by 1
nocache;

# 기존 컬럼에서 address 테이블로 병합
INSERT INTO address (address_id, province, district, road_name, building)
SELECT
   address_id.NEXTVAL AS address_id,
   C.province AS province,
   c.district AS district,
   C.road_name || ' ' || DECODE(A.building_num_sub, '0', TO_CHAR(A.building_num_main), TO_CHAR(A.building_num_main || '-' || A.building_num_sub)) AS road_name,
   S.building_name2 AS building
FROM
   road_address A, road_code C, road_subdata S
WHERE
   A.address_code = S.address_code AND
   A.road_code = C.road_code AND
   A.town_code = C.town_code;

# Address 테이블 인덱스 생성
create index search_road
ON address (road_name);
